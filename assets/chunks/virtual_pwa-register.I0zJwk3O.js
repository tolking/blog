import{V as m}from"./framework.C1tv1HY1.js";function _(p={}){const{immediate:u=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:o,onRegisteredSW:l,onRegisterError:r}=p;let t,d,s;const w=async(e=!0)=>{await d,await(s==null?void 0:s())};async function f(){if("serviceWorker"in navigator){if(t=await m(async()=>{const{Workbox:e}=await import("./workbox-window.prod.es5.D5gOYdM7.js");return{Workbox:e}},[]).then(({Workbox:e})=>new e("/service-worker.js",{scope:"/",type:"classic"})).catch(e=>{r==null||r(e)}),!t)return;s=async()=>{await(t==null?void 0:t.messageSkipWaiting())};{let e=!1;const c=()=>{e=!0,t==null||t.addEventListener("controlling",a=>{a.isUpdate&&window.location.reload()}),n==null||n()};t.addEventListener("installed",a=>{typeof a.isUpdate>"u"?typeof a.isExternal<"u"?a.isExternal?c():!e&&(i==null||i()):a.isExternal?window.location.reload():!e&&(i==null||i()):a.isUpdate||i==null||i()}),t.addEventListener("waiting",c),t.addEventListener("externalwaiting",c)}t.register({immediate:u}).then(e=>{l?l("/service-worker.js",e):o==null||o(e)}).catch(e=>{r==null||r(e)})}}return d=f(),w}export{_ as registerSW};
